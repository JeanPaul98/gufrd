<table bordered  cTable>
    <thead>
      <tr>
        <th class="tw-text-sm tw-text-secondary" scope="col">N° ORDRE</th>
        <th class="tw-text-sm tw-text-secondary" scope="col">N° DEMANDE</th>
        <th class="tw-text-sm tw-text-secondary" scope="col">AGREMENT</th>
        <th class="tw-text-sm tw-text-secondary" scope="col">RAISON SOCIALE</th>
        <th class="tw-text-sm tw-text-secondary" scope="col">PROVENANCE</th>
        <th class="tw-text-sm tw-text-secondary" scope="col">REDEVANCE</th>
        <th class="tw-text-sm tw-text-secondary" scope="col">STATUS PAIEMENT</th>
        <th class="tw-text-sm tw-text-secondary" scope="col">STATUS DEMANDE</th>
        <th class="tw-text-sm tw-text-secondary" scope="col">MOTIF</th>
        <th class="tw-text-sm tw-text-secondary" scope="col">DATE REJET</th>
        <th class="tw-text-sm tw-text-secondary" scope="col">ACTION</th>
      </tr>
        @if (loadingDemands) {
          <tr>
            <td colspan="11" class="tw-text-center !tw-my-0 !tw-p-0">
              <app-loading-bar></app-loading-bar>
            </td>
          </tr>
        }
    </thead>
    <tbody>
      @for(demand of demands(); track demand; ) {
        <tr>
          <td>{{ $index + 1 }}</td>
          <td>
            <a [routerLink]="['/demand/details', demand.idFormalite]"  (click)="xendDetailsInfo(demand)"
               class="tw-inline-flex tw-items-center tw-font-medium tw-text-blue-600 hover:tw-cursor-pointer hover:tw-underline">
              {{ demand.numGenerer }}
              <svg class="tw-w-5 tw-h-5 tw-ms-2 rtl:tw-rotate-180" xmlns="http://www.w3.org/2000/svg" width="18"
                   height="18" viewBox="0 0 24 24">
                <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M11 4H4v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-5M9 15L20 4m-5 0h5v5"/>
              </svg>
            </a>
          </td>
          <td scope="row">
            {{ demand.numeroAgrement }}
          </td>
          <td>{{ demand.nomSociete }}</td>
          <td>{{ demand.provenance }}</td>
          <td>{{ demand.montantRedevance | price}}</td>
          <td>
            @if (demand.montantRedevance === 0) {
              <span
                class="tw-py-1 tw-px-2 tw-inline-flex tw-items-center tw-gap-x-1 tw-font-medium  tw-bg-zinc-200 tw-text-zinc-600 tw-rounded-full"
              >
              {{demand.montantRedevance > 0  ? demand.statutPaiement : 'Gratuit' }}
              </span>
            } @else if (demand.montantRedevance > 0 && demand.statutPaiement === 'PAYER') {
              <span
                class="tw-py-1 tw-px-2 tw-inline-flex tw-items-center tw-gap-x-1 tw-font-medium  tw-bg-emerald-100 tw-text-emerald-700 tw-rounded-full"
              >
              {{demand.montantRedevance > 0  ? demand.statutPaiement : 'Payé' }}
              </span>
            } @else if (demand.montantRedevance > 0 && demand.statutPaiement === 'IMPAYER') {
              <span
                class="tw-py-1 tw-px-2 tw-inline-flex tw-items-center tw-gap-x-1 tw-font-medium  tw-bg-orange-100 tw-text-orange-600 tw-rounded-full"
              >
              {{demand.montantRedevance > 0  ? demand.statutPaiement : 'Impayé' }}
              </span>
            }
          </td>
          <td>
              <span
                class="tw-py-1 tw-px-2 tw-inline-flex tw-items-center tw-gap-x-1 tw-font-medium tw-bg-red-100 tw-text-red-500 tw-rounded-full"
              >
                {{demand.etat === 'REJETER' && 'Rejetée'}}
                <svg xmlns="http://www.w3.org/2000/svg" width="13" height="13" viewBox="0 0 15 15"><path fill="currentColor" d="M3.64 2.27L7.5 6.13l3.84-3.84A.92.92 0 0 1 12 2a1 1 0 0 1 1 1a.9.9 0 0 1-.27.66L8.84 7.5l3.89 3.89A.9.9 0 0 1 13 12a1 1 0 0 1-1 1a.92.92 0 0 1-.69-.27L7.5 8.87l-3.85 3.85A.92.92 0 0 1 3 13a1 1 0 0 1-1-1a.9.9 0 0 1 .27-.66L6.16 7.5L2.27 3.61A.9.9 0 0 1 2 3a1 1 0 0 1 1-1c.24.003.47.1.64.27"/></svg>
              </span>
          </td>
          <td>
            <!-- <span
               class="tw-py-1 tw-px-2 tw-inline-flex tw-items-center tw-gap-x-1 tw-font-medium tw-bg-purple-100 tw-text-purple-500 tw-rounded-full"
             >
           {{demand.etat === 'ACCEPTER' && 'Accepté'}}
               <svg
                 xmlns="http://www.w3.org/2000/svg"
                 width="13"
                 height="13"
                 viewBox="0 0 13 13"
                 fill="none"
               >
                 <path
                   fill-rule="evenodd"
                   clip-rule="evenodd"
                   d="M4.60614 10.4098L0.852727 6.69095C0.559833 6.39561 0.559833 5.91677 0.852727 5.62143C1.14562 5.32608 1.62049 5.32608 1.91339 5.62143L5.13356 8.7901L11.3497 2.59651C11.6426 2.30116 12.1175 2.30116 12.4104 2.59651C12.7033 2.89185 12.7033 3.37069 12.4104 3.66603L5.65761 10.4063C5.36674 10.6965 4.89889 10.6981 4.60614 10.4098Z"
                   fill="currentColor"
                 />
               </svg>
             </span>-->
            {{demand.motifRejet}}
          </td>
          <td>{{demand.dateRejet | date: 'dd/MM/yyyy: HH:mm'}}</td>
          <td>
            <button (click)="xendDetailsInfo(demand)" [routerLink]="['/demand/edit', 'step1']" cTooltip="Editer"
                    class="!tw-text-blue-600 !tw-bg-blue-100 hover:!tw-text-blue-700 !tw-mr-3" cButton color="light">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
                <path fill="currentColor"
                      d="M6 22q-.825 0-1.412-.587T4 20V4q0-.825.588-1.412T6 2h8l6 6v3q-.575.125-1.075.4t-.925.7l-6 5.975V22zm8 0v-3.075l5.525-5.5q.225-.225.5-.325t.55-.1q.3 0 .575.113t.5.337l.925.925q.2.225.313.5t.112.55t-.1.563t-.325.512l-5.5 5.5zm6.575-5.6l.925-.975l-.925-.925l-.95.95zM13 9h5l-5-5l5 5l-5-5z"/>
              </svg>
            </button>
          </td>
          </tr>
    }
      @if (demands().length === 0 && loadingDemands === false) {
      <tr>
        <td colspan="10" class="tw-text-center">Aucun résultat</td>
      </tr>
    }
      @if (loadingDemands) {
        <tr>
          <td colspan="10" class="tw-text-center !tw-text-gray-400">En cours de chargement...</td>
        </tr>
      }
    </tbody>
  </table>
  <div class="bottom-table tw-flex tw-flex-row tw-justify-between tw-item-center">
    <div class="tw-flex tw-flex-row tw-justify-center tw-items-center">
      <div>{{demands().length}} resultats</div>
    </div>
    <div class="action-button tw-flex tw-item-center tw-flex-row tw-justify-end !tw-gap-1">
      <button
        class="!tw-gap-2 !tw-flex !tw-items-center !tw-shadow-button hover:!tw-bg-secondary-light !tw-border !tw-bg-white !tw-border-border-secondary"

        cButton
        color="light"
      >
        <span>Préçédent</span>
      </button>
      <button
        class="!tw-gap-2 !tw-flex !tw-items-center !tw-shadow-button hover:!tw-bg-secondary-light !tw-border !tw-bg-white !tw-border-border-secondary"

        cButton
        color="light"
      >
        <span>Suivant</span>
      </button>
    </div>
  </div>
